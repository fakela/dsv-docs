[title]: # (SIEM Integrations)
[tags]: # (DevOps Secrets Vault,DSV,)
[priority]: # (8000)

###Audits:  
DSV captures audits of activities and persist them for future use. If the User want to ship their audits to third party, they can configure endpoints and DSV will send to configured endpoints near real time.
Please see below the supported output format and transport. 

Audit Fields: 

attribute  | description | example 
------------ | ------------- |------------
id | Audit id | "dxv7389e463s72jbo345"
tenant | Tenant ID | "bjr738973p3s72jbo090"
tenantName | Tenant Name | "test"
principal  | Security principal that performed action | "users:user",
principalItemId | Principal item ID | 86b1c1aa-907e-41b8-8b02-e8d7dd467d6a"
action | Action performed  | "POST",
Status | Response status code  | "200",
path | Resource path action performed on  | token",
ipaddress  | IP Address logged from client  | "52.23.227.163",
created | Audit created date  | "2020-05-01T01:09:07.225694779Z",
message |  Additional details | "login succeeded"


### Logging Format 

####Syslog
Syslog messages must be in RFC 5424-compliant form. DSV will truncated messages over 64KB in length.
  
######Mapping 

Syslog | Audit
-------|--------
Timestamp | RFC3339 format
Priority | 191
Version | 1
Hostname | Tenant DSV URL (tenantName+"."+dsvdomainname)
MsgID |id
Appname|DSV
Message | usertoken message
StructuredData | all other audit fields 


```
Note:   A user-specific token, generated by user, is inserted into each message to identify the user
```
######Sample syslog output
```
<191>1 2020-06-02T14:53:48Z tenantName.dsvdomain.com DSV - - [1 action=\"POST\" created=\"2020-06-02T14:51:36.519620577Z\" ipaddress=\"75.188.210.58\" path=\"token\" principal=\"users:tenantaame\" principalItemId=\"f18b5bda-51ea-4bfa-b272-80b12e43b676\" tenant=\"tenant\" tenantName=\"mal\"] abcdef "
```
######Configure Syslog 
 
Create siem config in CLI and follow the work flow  

```bash
thy siem create
```
name:           required    
siemType:       required, allowed values: syslog   
host:           required, url   
port:           required, numeric     
protocol:       required, allowed values: tcp, udp, http, https, tls      
authMethod:     required, allowed values: token   
auth:           required   
loggingFormat:  required, allowed values: rfc5424   

######Sample Values 

```json
{
	"siemType": "syslog",
	"name": "syslogtest",
	"host": "54.210.93.200",
	"port": 8000,
	"protocol": "tls",
	"authMethod": "token",
	"auth": "abcdef",
	"loggingFormat": "rfc5424"
}

```

####CEF

######Mapping  
CEF | DSV Audit   | description   
-------|------ |-----------
Version | 0  | constant 
Device Product |  thycotic  | constant
Device Product | dsv  | constant
Device Version | - | unused by dsv
Signature ID | id | audit field
Name | action | audit field
Severity | status |  see below for translation 
Extension| | all other audit fields
              
severity        
 status -> Severity  
 200 -> 0    
 400 -> 1        
 401 -> 7        
 403 -> 7        
 404 -> 0               
 500 -> 0        
 anything else -> _   


######Sample CEF output
```
CEF:0|thycotic|dsv|-|b40e07d3-6fb9-41e8-9816-356de992b8fa|POST|0|{\"action\":\"POST\",\"created\":\"2020-06-02T17:52:30.841020649Z\",\"id\":\"b40e07d3-6fb9-41e8-9816-356de992b8fa\",\"ipaddress\":\"75.188.210.58\",\"message\":\"login succeeded\",\"path\":\"token\",\"principal\":\"users:user\",\"principalItemId\":\"f18b5bda-51ea-4bfa-b272-80b12e43b676\",\"status\":\"\",\"tenant\":\"tenat\",\"tenantName\":\"tenantName\"}
```   

######Configure CEF 

Create siem config in CLI and follow the work flow 
 
```bash
thy siem create
```
name:           required    
siemType:       required, allowed values: cef   
host:           required, url   
port:           required, numeric     
protocol:       required, allowed values: tcp, udp, http, https, tls      
authMethod:     required, allowed values: token   
auth:           required   
loggingFormat:  required, allowed values: cef   

######Sample Values 
```json
{
	"siemType": "cef",
	"name": "syslogtest",
	"host": "34.210.93.200",
	"port": 8678,
	"protocol": "udp",
	"authMethod": "token",
	"auth": "abcdef",
	"loggingFormat": "cef"
}

```

###Json
DSV will send raw json audit via configure transport 

######Sample json  output
```json
{\"action\":\"POST\",\"created\":\"2020-06-02T17:52:30.841020649Z\",\"id\":\"b40e07d3-6fb9-41e8-9816-356de992b8fa\",\"ipaddress\":\"75.188.210.58\",\"message\":\"login succeeded\",\"path\":\"token\",\"principal\":\"users:user\",\"principalItemId\":\"f18b5bda-51ea-4bfa-b272-80b12e43b676\",\"status\":\"\",\"tenant\":\"tenat\",\"tenantName\":\"tenantName\"}
```
######Configure Syslog 

Create siem config in CLI and follow the work flow 
 
```bash
thy siem create
```
name:           required    
siemType:       required, allowed values: json   
host:           required, url   
port:           required, numeric     
protocol:       required, allowed values: tcp, udp, http, https, tls      
authMethod:     required, allowed values: token   
auth:           required   
loggingFormat:  required, allowed values: json   

######Sample Values 
```json
{
	"siemType": "json",
	"name": "syslogtest",
	"host": "34.210.93.200",
	"port": 443,
	"protocol": "https",
	"authMethod": "token",
	"auth": "abcdef",
	"loggingFormat": "cef"
}

```

## Transport Supported:
#### DSV Support the following  Transport protocol   
Transport-level security (TLS) 1.2 over TCP,
TCP, UDP, HTTP and HTTPS.



